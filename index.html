<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>XXXVault</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: linear-gradient(to right, #2c003e, #5e005e, #960036);
      color: white;
    }
    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      padding: 10px 20px;
      background: #1a001f;
      box-shadow: 0 0 10px #e91e63;
    }
    .brand {
      display: flex;
      align-items: center;
      font-size: 2.5em;
      font-weight: bold;
      color: #ff69b4;
      gap: 10px;
    }
    .red-heart {
      color: red;
      font-size: 1.2em;
    }
    .search-login-area {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 10px;
      margin-top: 10px;
    }
    .search-login-area input[type="text"] {
      padding: 8px;
      border-radius: 4px;
      border: none;
      width: 200px;
    }
    .search-login-area select,
    .search-login-area button {
      padding: 8px 12px;
      border-radius: 4px;
      border: none;
      cursor: pointer;
      background-color: #ff69b4;
      color: white;
    }
    .categories {
      overflow-x: auto;
      white-space: nowrap;
      background: #2c002f;
      padding: 10px 0;
      box-shadow: inset 0 -1px 0 #ff69b4;
    }
    .categories button {
      background-color: #ff1493;
      color: white;
      border: none;
      border-radius: 20px;
      padding: 8px 14px;
      margin: 5px;
      font-weight: bold;
      cursor: pointer;
    }
    .video-list {
      max-width: 900px;
      margin: auto;
      padding: 20px;
    }
    .video-card {
      background-color: rgba(0,0,0,0.6);
      margin-bottom: 20px;
      border-radius: 10px;
      padding: 15px;
      box-shadow: 0 0 10px #ff69b4;
    }
    .video-card iframe {
      width: 100%;
      height: 250px;
      border-radius: 10px;
    }
    .meta {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
      flex-wrap: wrap;
    }
    .description {
      font-size: 0.9em;
      margin-top: 5px;
      color: #ffb6c1;
    }
    .comment-box {
      margin-top: 10px;
    }
    .comment-box input {
      width: 80%;
      padding: 8px;
      border-radius: 4px;
      border: none;
    }
    .comment-box button {
      padding: 8px 12px;
      margin-left: 5px;
      background-color: #ff69b4;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .comments-display {
      margin-top: 10px;
      font-size: 0.85em;
      color: #ccc;
    }
    .video-tags {
      margin-top: 10px;
      display: flex;
      flex-wrap: wrap;
    }
    .video-tags button {
      margin: 4px 5px 0 0;
      background: #ff69b4;
      color: white;
      border: none;
      border-radius: 16px;
      padding: 4px 10px;
      cursor: pointer;
      font-size: 0.8em;
    }
    @media(max-width: 768px) {
      .header {
        flex-direction: column;
        text-align: center;
      }
      .search-login-area input[type="text"] {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="brand">
      <span class="red-heart">‚ù§</span>
      <span id="siteTitle">XXXVault</span>
    </div>
    <div class="search-login-area">
      <input type="text" id="searchInput" placeholder="Search for videos...">
      <button onclick="searchVideos()" id="searchBtn">Search</button>
      <select id="languageSelect" onchange="setLanguage()">
        <option value="en">EN</option>
        <option value="hi">HI</option>
      </select>
      <button onclick="alert('Login clicked')" id="loginBtn">Login</button>
      <button onclick="alert('Signup clicked')" id="signupBtn">Signup</button>
    </div>
  </div>

  <div class="categories" id="categoryBar"></div>
  <div class="video-list" id="videoList"></div>

  <script>
    function setLanguage() {
      const lang = document.getElementById("languageSelect").value;
      const translations = {
        en: {
          siteTitle: 'XXXVault',
          searchPlaceholder: 'Search for videos...',
          searchBtn: 'Search',
          login: 'Login',
          signup: 'Signup'
        },
        hi: {
          siteTitle: 'XXXVault',
          searchPlaceholder: '‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§ñ‡•ã‡§ú‡•á‡§Ç...',
          searchBtn: '‡§ñ‡•ã‡§ú‡•á‡§Ç',
          login: '‡§≤‡•â‡§ó‡§ø‡§®',
          signup: '‡§∏‡§æ‡§á‡§®‡§Ö‡§™'
        }
      };
      const t = translations[lang];
      document.getElementById("siteTitle").innerText = t.siteTitle;
      document.getElementById("searchInput").placeholder = t.searchPlaceholder;
      document.getElementById("searchBtn").innerText = t.searchBtn;
      document.getElementById("loginBtn").innerText = t.login;
      document.getElementById("signupBtn").innerText = t.signup;
    }

    const categories = [/* Your list of categories here... */];

    const categoryBar = document.getElementById("categoryBar");

    function displayCategories() {
      categories.sort().forEach(cat => {
        const btn = document.createElement('button');
        btn.textContent = cat;
        btn.onclick = () => filterByCategory(cat);
        categoryBar.appendChild(btn);
      });
    }
  </script>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, collection, getDocs, addDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCcWNBqcYhgVzs8DIgB7D8vmDu8if-a8zo",
      authDomain: "xxxvault-28f70.firebaseapp.com",
      projectId: "xxxvault-28f70",
      storageBucket: "xxxvault-28f70.appspot.com",
      messagingSenderId: "226704398059",
      appId: "1:226704398059:web:9f02b1013f14ada73090ae"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const videoList = document.getElementById("videoList");
    let allVideos = [];

    async function loadVideos() {
      const querySnapshot = await getDocs(collection(db, "videos"));
      allVideos = [];
      querySnapshot.forEach((doc) => allVideos.push({ id: doc.id, ...doc.data() }));
      renderVideos(allVideos);
    }

    function extractEmbedUrl(embedString) {
      const match = embedString.match(/src\s*=\s*"([^"]+)/);
      return match ? match[1] : embedString;
    }

    function renderVideos(videos) {
      videoList.innerHTML = "";
      videos.forEach((video) => {
        const embedUrl = extractEmbedUrl(video.embed);
        const card = document.createElement("div");
        card.className = "video-card";
        const commentsHtml = (video.comments || []).map(c => `<div>${c}</div>`).join('');
        card.innerHTML = `
          <h3>${video.title}</h3>
          <iframe src="${embedUrl}" frameborder="0" allowfullscreen></iframe>
          <div class="meta">
            <span>üëÅ ${video.views || 0} views</span>
            <span>‚ù§Ô∏è ${video.likes || 0} Likes</span>
          </div>
          <div class="description">${video.description || ""}</div>
          <div class="comment-box">
            <input type="text" placeholder="Leave a comment..." id="comment-${video.id}" />
            <button onclick="submitComment('${video.id}')">Send</button>
            <div class="comments-display">${commentsHtml}</div>
          </div>
          <div class="video-tags"><button onclick="filterByCategory('${video.category}')">${video.category}</button></div>
        `;
        videoList.appendChild(card);
      });
    }

    window.submitComment = async function(videoId) {
      const commentInput = document.getElementById(`comment-${videoId}`);
      const comment = commentInput.value;
      if (!comment) return;
      const videoRef = collection(db, "videos");
      const querySnapshot = await getDocs(videoRef);
      let videoDoc = null;
      querySnapshot.forEach(doc => {
        if (doc.id === videoId) videoDoc = doc;
      });
      if (videoDoc) {
        const data = videoDoc.data();
        const comments = data.comments || [];
        comments.push(comment);
        await addDoc(collection(db, "videos"), {
          ...data,
          comments: comments
        });
        commentInput.value = "";
        loadVideos();
      }
    }

    function filterByCategory(cat) {
      const filtered = allVideos.filter(v => v.category?.toLowerCase() === cat.toLowerCase());
      renderVideos(filtered);
    }

    window.searchVideos = function () {
      const query = document.getElementById("searchInput").value.toLowerCase();
      const filtered = allVideos.filter(v =>
        v.title?.toLowerCase().includes(query) ||
        v.category?.toLowerCase().includes(query)
      );
      renderVideos(filtered);
    };

    displayCategories();
    loadVideos();
  </script>
</body>
</html>
